# ๐จ RISK_INDICATORS_AND_IR.md

## ูุคุดุฑุงุช ุงูุฎุทุฑ (Risk Indicators)

### ๐ฅ **Critical Risks - ุฎุทุฑ ููุฑู**

#### **Flood/DDoS Attacks**
**ุงููุคุดุฑุงุช:**
- ุฒูุงุฏุฉ ููุงุฌุฆุฉ ูู ุงูุทูุจุงุช (> 300% ูู ุงููุนุฏู ุงูุทุจูุนู)
- ุจุทุก ุงุณุชุฌุงุจุฉ API (> 5 ุซูุงูู)
- ุฃุฎุทุงุก 503/504 Service Unavailable
- ุงุณุชููุงู CPU/Memory ุบูุฑ ุทุจูุนู (> 90%)
- ุทูุจุงุช ูู IPs ูุชุนุฏุฏุฉ ุจููุณ ุงูููุท

#### **Token/Session Theft**
**ุงููุคุดุฑุงุช:**
- ูุญุงููุงุช ุฏุฎูู ูุชูุฑุฑุฉ ุจุชูููุงุช ููุชููุฉ ุงูุตูุงุญูุฉ
- ุฌูุณุงุช ูุดุทุฉ ูู ููุงูุน ุฌุบุฑุงููุฉ ูุชุจุงุนุฏุฉ ูููุณ ุงููุณุชุฎุฏู
- ุฃูุดุทุฉ ุบูุฑ ุทุจูุนูุฉ (ุชุณุฌูู ุฏุฎูู ูู 3 ุฏูู ุฎูุงู ุณุงุนุฉ)
- ุชุบููุฑ ููุงุฌุฆ ูู User-Agent ุฃู Device Fingerprint
- ูุญุงููุงุช ุงููุตูู ููููุงุช admin ุจุฏูู ุตูุงุญูุงุช

#### **Database Compromise**
**ุงููุคุดุฑุงุช:**
- ุชุบููุฑุงุช ูู ุงูุจูุงูุงุช ุจุฏูู Audit Logs
- ุงุชุตุงูุงุช DB ูู IPs ุบูุฑ ูุนุฑููุฉ
- ุชุถุฎู ููุงุฌุฆ ูู ุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงุณุชุนูุงูุงุช SQL ุบูุฑ ุนุงุฏูุฉ (UNION, DROP, etc.)
- ูุดู ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุจุดูู ูุชูุฑุฑ

### โ๏ธ **Medium Risks - ุฎุทุฑ ูุชูุณุท**

#### **Game Economy Manipulation**
**ุงููุคุดุฑุงุช:**
- ูุณุชุฎุฏู ููุณุจ > 10,000 ุนููุฉ ูู ุณุงุนุฉ
- ุฅูุฌุงุฒ ููุงู ูู ููุช ุฃูู ูู ุงูุญุฏ ุงูุฃุฏูู ุงูููุทูู
- ุฃููุงุท ูุนุจ ุบูุฑ ุจุดุฑูุฉ (ููุณ ุงูุชูููุช ุจุงูุถุจุท)
- ุญุณุงุจุงุช ุฌุฏูุฏุฉ ุชุญูู ุฅูุฌุงุฒุงุช ุนุงููุฉ ููุฑูุงู

#### **API Abuse**
**ุงููุคุดุฑุงุช:**
- ุงุณุชุฎุฏุงู endpoints ุจุทุฑููุฉ ุบูุฑ ูุชููุนุฉ
- ุทูุจุงุช API ุจุฏูู User-Agent ุฃู ูุนูููุงุช Device
- ูุญุงููุงุช brute force ุนูู API keys
- ุงุณุชููุงู bandwidth ุบูุฑ ุทุจูุนู ููุณุชุฎุฏู ูุงุญุฏ

### ๐ **Low Risks - ูุฑุงูุจุฉ ุนุงูุฉ**

#### **Performance Degradation**
**ุงููุคุดุฑุงุช:**
- ุชุฏููุฑ ุชุฏุฑูุฌู ูู ุฃููุงุช ุงูุงุณุชุฌุงุจุฉ
- ุฒูุงุฏุฉ ูุนุฏู ุงูุฃุฎุทุงุก 4xx/5xx
- ุดูุงูู ุงููุณุชุฎุฏููู ูู ุงูุจุทุก

---

## ๐ ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ ููุญูุงุฏุซ (Incident Response)

### ๐ฅ **ุฅุฌุฑุงุกุงุช ููุฑูุฉ (< 5 ุฏูุงุฆู)**

#### **Flood/DDoS Response**
```bash
# 1. ุชุดุฏูุฏ Rate Limits ููุฑุงู
# ูู Laravel: config/throttle.php
'api' => [
    'max_attempts' => 10,  # ุจุฏูุงู ูู 60
    'decay_minutes' => 1,
],

# 2. ุชูุนูู Cloudflare "Under Attack Mode"
# 3. ูุฑุงูุจุฉ Server Resources
htop
iostat 1
```

**ุงูุฅุฌุฑุงุกุงุช:**
1. **ุชุดุฏูุฏ ุงูู Rate Limits** ุฅูู 10 ุทูุจุงุช/ุฏูููุฉ
2. **ุชูุฑูุฑ ุงูุญุฑูุฉ ุนุจุฑ WAF** (Cloudflare/AWS Shield)
3. **ุนุฒู ุงูุฎุฏูุงุช ุงููุชุฃุซุฑุฉ** ูุชูุฌูู ุงูุญุฑูุฉ ููู backup
4. **ุฑูุน ุงูุณุนุฉ ูุคูุชุงู** (Scale-up instances)
5. **ุญุธุฑ IPs ุงููุดุจููุฉ** ูู Firewall

#### **Token Theft Response**
```php
// Force logout ุฌููุน ุงููุณุชุฎุฏููู
Artisan::call('sanctum:prune-expired', ['--hours' => 0]);

// ุชุฏููุฑ JWT Secret
php artisan jwt:secret --force

// ุชุนุทูู ุฌูุณุงุช ูุนููุฉ
DB::table('personal_access_tokens')
  ->where('tokenable_id', $suspicious_user_id)
  ->delete();
```

**ุงูุฅุฌุฑุงุกุงุช:**
1. **Force Logout ุดุงูู** ูุฌููุน ุงููุณุชุฎุฏููู
2. **ุชุฏููุฑ ููุงุชูุญ JWT/Sanctum** ููุฑุงู
3. **ูุฑุถ ุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู** ูุน ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
4. **ุชูุนูู 2FA ุฅุฌุจุงุฑู** ููุญุณุงุจุงุช ุงูุฅุฏุงุฑูุฉ
5. **ูุฑุงุฌุนุฉ Access Logs** ูุชุญุฏูุฏ ุงููุดุงุท ุงููุดุจูู

#### **Database Breach Response**
```sql
-- ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูููุฑุงุกุฉ ููุท
FLUSH TABLES WITH READ LOCK;
SET GLOBAL read_only = ON;

-- ูุญุต ุณุฑูุน ููุชุบููุฑุงุช ุงููุดุจููุฉ
SELECT * FROM audit_logs 
WHERE created_at > '2025-09-14 00:00:00' 
ORDER BY created_at DESC;
```

**ุงูุฅุฌุฑุงุกุงุช:**
1. **ููู ุงููุฑุงุกุฉ ููุท** ูููุน ุงููุฒูุฏ ูู ุงูุชุฏููุฑ
2. **ุงุณุชุฑุฌุงุน ุขุฎุฑ Backup ููุซูู** ููุฑุงู
3. **ุชุฏููุฑ ูููุงุช ูุฑูุฑ/ููุงุชูุญ** ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. **ูุฑุงุฌุนุฉ Logs** ูุชุญุฏูุฏ ูุตุฏุฑ ุงูุงุฎุชุฑุงู
5. **ุฅุบูุงู ุงุชุตุงูุงุช DB** ุบูุฑ ุงููุตุฑุญ ุจูุง

### โก **ุฅุฌุฑุงุกุงุช ูุชูุณุทุฉ ุงููุฏู (< 1 ุณุงุนุฉ)**

#### **Primary Server Outage**
**ุงููุคุดุฑุงุช:**
- ุงุฑุชูุงุน ุฃุฎุทุงุก 500/503 > 50%
- ูุดู ุงูุงุชุตุงู ุจู DB/Redis
- ุนุฏู ุงุณุชุฌุงุจุฉ Health Checks

**ุงูุงุณุชุฌุงุจุฉ:**
1. **ุงูุชุญููู ุฅูู ุฎุงุฏู ุจุฏูู/Staging**
2. **ุงุณุชุฑุฌุงุน ุฃุญุฏุซ ูุณุฎุฉ DB** ุนูู ุงูุจุฏูู
3. **ุฅุฎุทุงุฑ ุงููุณุชุฎุฏููู** ุนุจุฑ Status Page
4. **ุงูุชุฎุทูุท ูู HA** (Load Balancer + ุชุนุฏุฏ ุฎูุงุฏู)

#### **Game Economy Investigation**
```php
// ุงูุจุญุซ ุนู ุงููุดุงุท ุงููุดุจูู
$suspicious = DB::table('transactions')
    ->where('amount', '>', 1000)
    ->where('created_at', '>', now()->subHour())
    ->groupBy('user_id')
    ->having(DB::raw('COUNT(*)'), '>', 10)
    ->get();

// ุชุฌููุฏ ุงูุญุณุงุจุงุช ุงููุดุจููุฉ
User::whereIn('id', $suspicious->pluck('user_id'))
    ->update(['status' => 'suspended']);
```

### ๐ **ุฅุฌุฑุงุกุงุช ุงููุชุงุจุนุฉ (< 24 ุณุงุนุฉ)**

#### **Post-Incident Analysis**
1. **Root Cause Analysis** ููุตู
2. **ุชุญุฏูุซ Security Measures** ูููุน ุงูุชูุฑุงุฑ
3. **Training Team** ุนูู ุงูุงุณุชุฌุงุจุฉ
4. **Documentation** ูุงูู ููุญุงุฏุซุฉ

#### **Prevention Improvements**
1. **Enhanced Monitoring** Rules
2. **Automated Response** Scripts
3. **Security Testing** ุฅุถุงูู
4. **Backup Strategy** ุชุญุณูู

---

## ๐ง ุฃุฏูุงุช ุงููุฑุงูุจุฉ ูุงูุงุณุชุฌุงุจุฉ

### **Monitoring Stack**
```yaml
# docker-compose.monitoring.yml
version: '3.8'
services:
  prometheus:
    image: prom/prometheus
    ports: ['9090:9090']
  
  grafana:
    image: grafana/grafana
    ports: ['3000:3000']
    
  alertmanager:
    image: prom/alertmanager
    ports: ['9093:9093']
```

### **Automated Alerts**
```php
// ูู Laravel: app/Console/Commands/SecurityMonitor.php
if ($failed_logins > 100) {
    // ุฅุฑุณุงู ุชูุจูู ููุฑู
    Mail::to('admin@example.com')->send(new SecurityAlert());
    
    // ุชูุนูู ุฅุฌุฑุงุกุงุช ุญูุงูุฉ ุฅุถุงููุฉ
    Cache::put('security_mode', true, 3600);
}
```

### **Emergency Contacts**
- **Technical Lead**: [ุฑูู ุงููุงุชู]
- **System Admin**: [ุฑูู ุงููุงุชู]  
- **Security Team**: [ุงูุจุฑูุฏ ุงูุฅููุชุฑููู]
- **Management**: [ูุนูููุงุช ุงูุงุชุตุงู]

---

## ๐ **ุฅุฌุฑุงุกุงุช ุงูุชุตุนูุฏ (Escalation)**

### **Level 1 - Developer Response** (< 15 ุฏูููุฉ)
- ุฃู ูุทูุฑ ูุชุงุญ ููููู ุงูุชุนุงูู ูุน ุงููุดููุฉ
- ุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช ุงูุฃุณุงุณูุฉ ูุงูู scripts ุงูุฌุงูุฒุฉ

### **Level 2 - Senior/Lead Response** (< 30 ุฏูููุฉ)  
- ูุดุงูู ูุนูุฏุฉ ุชุญุชุงุฌ ุฎุจุฑุฉ ุฃุนูู
- ูุฑุงุฑุงุช ุชุชุนูู ุจุฅููุงู ุงูุฎุฏูุฉ ุฃู ุงูุชุญููู ููุจุฏูู

### **Level 3 - Management Involvement** (< 1 ุณุงุนุฉ)
- ุญูุงุฏุซ ูุจุฑู ุชุคุซุฑ ุนูู ุงูุนูู ุฃู ุงูุณูุนุฉ
- ูุฑุงุฑุงุช ูุงููุฉ ุฃู ูุงููููุฉ
- ุฅุดุฑุงู ูุฑู ุฎุงุฑุฌูุฉ (ูุฒูุฏ ุงูุงุณุชุถุงูุฉุ ุงููุงููููุฉ)

---

**ุขุฎุฑ ุชุญุฏูุซ**: 14 ุณุจุชูุจุฑ 2025  
**ุญุงูุฉ ุงูุงุณุชุนุฏุงุฏ**: Basic Planning (ูู ูุชู ุชุทุจูู ุงูุฃุฏูุงุช ุจุนุฏ)  
**ุงูุชุงูู**: ุฅุนุฏุงุฏ Monitoring ุงูุฃุณุงุณู + Emergency Scripts