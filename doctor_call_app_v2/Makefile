# Doctor Call App v2 - Makefile
# ููู ููุชุญูู ูู ุนูููุงุช ุงูุจูุงุก ูุงููุดุฑ

.PHONY: help github-deploy prepare-deploy clean test analyze run-web run-mobile install

# Default target
help:
	@echo "๐ฅ Doctor Call App v2 - ุฃูุงูุฑ ุงูุชุทููุฑ ูุงููุดุฑ"
	@echo ""
	@echo "ุงูุฃูุงูุฑ ุงููุชุงุญุฉ:"
	@echo "  help          ุนุฑุถ ูุฐู ุงููุงุฆูุฉ"
	@echo "  install       ุชุซุจูุช ุงูุชุจุนูุงุช"
	@echo "  github-deploy ุฑูุน ุฅูู GitHub ููุจูุงุก ูุงููุดุฑ ุงูุชููุงุฆู"
	@echo "  prepare-deploy ุชุฌููุฒ ุงููููุงุช ูููุดุฑ"
	@echo "  clean         ุชูุธูู ูููุงุช ุงูุชุทููุฑ"
	@echo "  test          ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช"
	@echo "  analyze       ุชุญููู ุงูููุฏ"
	@echo "  run-web       ุชุดุบูู ุงูุชุทุจูู ูู ุงููุชุตูุญ"
	@echo "  run-mobile    ุชุดุบูู ุงูุชุทุจูู ุนูู ุงููุงุชู"
	@echo "  format        ุชูุณูู ุงูููุฏ"
	@echo "  upgrade       ุชุญุฏูุซ ุงูุชุจุนูุงุช"
	@echo ""

# Install dependencies
install:
	@echo "๐ฆ ุชุซุจูุช ุงูุชุจุนูุงุช..."
	flutter pub get
	@echo "โ ุชู ุชุซุจูุช ุงูุชุจุนูุงุช ุจูุฌุงุญ"

# GitHub deployment - automatic build and deploy
github-deploy:
	@echo "๏ฟฝ ุฑูุน ุฅูู GitHub ููุจูุงุก ูุงููุดุฑ ุงูุชููุงุฆู..."
	@echo "๐ ุงูุชุญูู ูู ุงูุชุบููุฑุงุช..."
	git add .
	@echo "๐ค ุฑูุน ุงููููุงุช ุฅูู GitHub..."
	git status
	@read -p "ุฃุฏุฎู ุฑุณุงูุฉ ุงูููููุช: " msg; \
	git commit -m "$$msg" || echo "โ๏ธ ูุง ุชูุฌุฏ ุชุบููุฑุงุช ุฌุฏูุฏุฉ"
	git push origin main
	@echo "โ ุชู ุงูุฑูุน ุจูุฌุงุญ! GitHub Actions ุณุชููู ุจุงูุจูุงุก ูุงููุดุฑ ุงูุชููุงุฆู"
	@echo "๐ ุณุชููู ูุชุงุญุฉ ุนูู: https://alebrahimi2.github.io/doctor-call-app/"

# Prepare files for deployment (no build)
prepare-deploy:
	@echo "๏ฟฝ ุชุฌููุฒ ุงููููุงุช ูููุดุฑ..."
	flutter pub get
	flutter analyze
	@echo "โ ุงููููุงุช ุฌุงูุฒุฉ ููุฑูุน ุฅูู GitHub"

# Clean development files
clean:
	@echo "๐งน ุชูุธูู ูููุงุช ุงูุชุทููุฑ..."
	flutter clean
	@echo "โ ุชู ุชูุธูู ุงููููุงุช"

# Run tests
test:
	@echo "๐งช ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช..."
	flutter test
	@echo "โ ุงูุชูุช ุงูุงุฎุชุจุงุฑุงุช"

# Analyze code
analyze:
	@echo "๐ ุชุญููู ุงูููุฏ..."
	flutter analyze
	@echo "โ ุงูุชูู ุชุญููู ุงูููุฏ"

# Run web application
run-web:
	@echo "๐ ุชุดุบูู ุงูุชุทุจูู ูู ุงููุชุตูุญ..."
	flutter run -d web-server --web-hostname 0.0.0.0 --web-port 8080

# Run mobile application
run-mobile:
	@echo "๐ฑ ุชุดุบูู ุงูุชุทุจูู ุนูู ุงููุงุชู..."
	flutter run

# Format code
format:
	@echo "โจ ุชูุณูู ุงูููุฏ..."
	dart format lib/
	dart format test/
	@echo "โ ุชู ุชูุณูู ุงูููุฏ"

# Upgrade dependencies
upgrade:
	@echo "๐ ุชุญุฏูุซ ุงูุชุจุนูุงุช..."
	flutter pub upgrade
	@echo "โ ุชู ุชุญุฏูุซ ุงูุชุจุนูุงุช"

# Full deployment pipeline
full-deploy: clean install analyze test build deploy
	@echo "๐ ุชู ุงูุงูุชูุงุก ูู ุนูููุฉ ุงููุดุฑ ุงููุงููุฉ!"

# Development setup
dev-setup: install
	@echo "โ๏ธ ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุทููุฑ..."
	flutter config --enable-web
	flutter doctor
	@echo "โ ุชู ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุทููุฑ"

# Create release
release: clean install analyze test build
	@echo "๐ฆ ุฅูุดุงุก ุฅุตุฏุงุฑ ุฌุฏูุฏ..."
	@echo "Version: $$(grep version pubspec.yaml | cut -d' ' -f2)"
	@echo "Build: $$(date +%Y%m%d-%H%M%S)"
	@echo "โ ุชู ุฅูุดุงุก ุงูุฅุตุฏุงุฑ"

# Quick development run
dev: install run-web

# Production build and deploy
prod: full-deploy
	@echo "๐ ุชู ูุดุฑ ุงูุฅุตุฏุงุฑ ุงูุฅูุชุงุฌู!"

# Show project status
status:
	@echo "๐ ุญุงูุฉ ุงููุดุฑูุน:"
	@echo "Flutter version: $$(flutter --version | head -1)"
	@echo "Dart version: $$(dart --version | cut -d' ' -f4)"
	@echo "Project: $$(grep name pubspec.yaml | cut -d' ' -f2)"
	@echo "Version: $$(grep version pubspec.yaml | cut -d' ' -f2)"
	@echo "Dependencies: $$(grep -c '  [a-z]' pubspec.yaml) packages"
	
# Show help in Arabic
help-ar:
	@echo "๐ฅ ุชุทุจูู Doctor Call v2 - ุฏููู ุงูุฃูุงูุฑ"
	@echo ""
	@echo "ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ:"
	@echo "  make install     - ุชุซุจูุช ุฌููุน ุงูุชุจุนูุงุช ุงููุทููุจุฉ"
	@echo "  make build       - ุจูุงุก ุงูุชุทุจูู ูููุดุฑ ุนูู ุงูููุจ"
	@echo "  make deploy      - ุชูุธูู ุงููููุงุช ููุดุฑูุง"
	@echo "  make run-web     - ุชุดุบูู ุงูุชุทุจูู ูุญููุงู ูู ุงููุชุตูุญ"
	@echo ""
	@echo "ุฃูุงูุฑ ุงูุชุทููุฑ:"
	@echo "  make test        - ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช"
	@echo "  make analyze     - ุชุญููู ุฌูุฏุฉ ุงูููุฏ"
	@echo "  make format      - ุชูุณูู ุงูููุฏ ุญุณุจ ูุนุงููุฑ Dart"
	@echo "  make clean       - ุชูุธูู ูููุงุช ุงูุจูุงุก ุงููุคูุชุฉ"
	@echo ""
	@echo "ุฃูุงูุฑ ูุชูุฏูุฉ:"
	@echo "  make full-deploy - ุนูููุฉ ูุดุฑ ูุงููุฉ (ุชูุธููุ ุงุฎุชุจุงุฑุ ุจูุงุกุ ูุดุฑ)"
	@echo "  make dev-setup   - ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุทููุฑ ูููุฑุฉ ุงูุฃููู"
	@echo "  make status      - ุนุฑุถ ูุนูููุงุช ุงููุดุฑูุน ูุงููุธุงู"
	@echo ""